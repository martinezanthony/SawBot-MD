let plugin = {};
plugin.cmd = ["adivinabandera", "bandera", "banderas"];
plugin.botAdmin = true;

const banderasLista = [
  { emoji: "ğŸ‡¦ğŸ‡«", pais: "afganistÃ¡n" },
  { emoji: "ğŸ‡¦ğŸ‡±", pais: "albania" },
  { emoji: "ğŸ‡©ğŸ‡¿", pais: "argelia" },
  { emoji: "ğŸ‡¦ğŸ‡©", pais: "andorra" },
  { emoji: "ğŸ‡¦ğŸ‡´", pais: "angola" },
  { emoji: "ğŸ‡¦ğŸ‡¬", pais: "antigua y barbuda" },
  { emoji: "ğŸ‡¦ğŸ‡·", pais: "argentina" },
  { emoji: "ğŸ‡¦ğŸ‡²", pais: "armenia" },
  { emoji: "ğŸ‡¦ğŸ‡º", pais: "australia" },
  { emoji: "ğŸ‡¦ğŸ‡¹", pais: "austria" },
  { emoji: "ğŸ‡¦ğŸ‡¿", pais: "azerbaiyÃ¡n" },
  { emoji: "ğŸ‡§ğŸ‡¸", pais: "bahamas" },
  { emoji: "ğŸ‡§ğŸ‡­", pais: "barÃ©in" },
  { emoji: "ğŸ‡§ğŸ‡©", pais: "bangladÃ©s" },
  { emoji: "ğŸ‡§ğŸ‡§", pais: "barbados" },
  { emoji: "ğŸ‡§ğŸ‡¾", pais: "bielorrusia" },
  { emoji: "ğŸ‡§ğŸ‡ª", pais: "bÃ©lgica" },
  { emoji: "ğŸ‡§ğŸ‡¿", pais: "belice" },
  { emoji: "ğŸ‡§ğŸ‡¯", pais: "benÃ­n" },
  { emoji: "ğŸ‡§ğŸ‡¹", pais: "butÃ¡n" },
  { emoji: "ğŸ‡§ğŸ‡´", pais: "bolivia" },
  { emoji: "ğŸ‡§ğŸ‡¦", pais: "bosnia y herzegovina" },
  { emoji: "ğŸ‡§ğŸ‡¼", pais: "botsuana" },
  { emoji: "ğŸ‡§ğŸ‡·", pais: "brasil" },
  { emoji: "ğŸ‡§ğŸ‡³", pais: "brunÃ©i" },
  { emoji: "ğŸ‡§ğŸ‡¬", pais: "bulgaria" },
  { emoji: "ğŸ‡§ğŸ‡«", pais: "burkina faso" },
  { emoji: "ğŸ‡§ğŸ‡®", pais: "burundi" },
  { emoji: "ğŸ‡¨ğŸ‡»", pais: "cabo verde" },
  { emoji: "ğŸ‡°ğŸ‡­", pais: "camboya" },
  { emoji: "ğŸ‡¨ğŸ‡²", pais: "camerÃºn" },
  { emoji: "ğŸ‡¨ğŸ‡¦", pais: "canadÃ¡" },
  { emoji: "ğŸ‡¶ğŸ‡¦", pais: "catar" },
  { emoji: "ğŸ‡¹ğŸ‡©", pais: "chad" },
  { emoji: "ğŸ‡¨ğŸ‡±", pais: "chile" },
  { emoji: "ğŸ‡¨ğŸ‡³", pais: "china" },
  { emoji: "ğŸ‡¨ğŸ‡¾", pais: "chipre" },
  { emoji: "ğŸ‡¨ğŸ‡´", pais: "colombia" },
  { emoji: "ğŸ‡°ğŸ‡²", pais: "comoras" },
  { emoji: "ğŸ‡¨ğŸ‡¬", pais: "congo" },
  { emoji: "ğŸ‡¨ğŸ‡©", pais: "repÃºblica democrÃ¡tica del congo" },
  { emoji: "ğŸ‡°ğŸ‡µ", pais: "corea del norte" },
  { emoji: "ğŸ‡°ğŸ‡·", pais: "corea del sur" },
  { emoji: "ğŸ‡¨ğŸ‡®", pais: "costa de marfil" },
  { emoji: "ğŸ‡¨ğŸ‡·", pais: "costa rica" },
  { emoji: "ğŸ‡­ğŸ‡·", pais: "croacia" },
  { emoji: "ğŸ‡¨ğŸ‡º", pais: "cuba" },
  { emoji: "ğŸ‡©ğŸ‡°", pais: "dinamarca" },
  { emoji: "ğŸ‡©ğŸ‡²", pais: "dominica" },
  { emoji: "ğŸ‡ªğŸ‡¨", pais: "ecuador" },
  { emoji: "ğŸ‡ªğŸ‡¬", pais: "egipto" },
  { emoji: "ğŸ‡¸ğŸ‡»", pais: "el salvador" },
  { emoji: "ğŸ‡¦ğŸ‡ª", pais: "emiratos Ã¡rabes unidos" },
  { emoji: "ğŸ‡ªğŸ‡·", pais: "eritrea" },
  { emoji: "ğŸ‡¸ğŸ‡°", pais: "eslovaquia" },
  { emoji: "ğŸ‡¸ğŸ‡®", pais: "eslovenia" },
  { emoji: "ğŸ‡ªğŸ‡¸", pais: "espaÃ±a" },
  { emoji: "ğŸ‡ºğŸ‡¸", pais: "estados unidos" },
  { emoji: "ğŸ‡ªğŸ‡ª", pais: "estonia" },
  { emoji: "ğŸ‡¸ğŸ‡¿", pais: "esuatini" },
  { emoji: "ğŸ‡ªğŸ‡¹", pais: "etiopÃ­a" },
  { emoji: "ğŸ‡«ğŸ‡¯", pais: "fiyi" },
  { emoji: "ğŸ‡µğŸ‡­", pais: "filipinas" },
  { emoji: "ğŸ‡«ğŸ‡®", pais: "finlandia" },
  { emoji: "ğŸ‡«ğŸ‡·", pais: "francia" },
  { emoji: "ğŸ‡¬ğŸ‡¦", pais: "gabÃ³n" },
  { emoji: "ğŸ‡¬ğŸ‡²", pais: "gambia" },
  { emoji: "ğŸ‡¬ğŸ‡ª", pais: "georgia" },
  { emoji: "ğŸ‡¬ğŸ‡­", pais: "ghana" },
  { emoji: "ğŸ‡¬ğŸ‡·", pais: "grecia" },
  { emoji: "ğŸ‡¬ğŸ‡©", pais: "granada" },
  { emoji: "ğŸ‡¬ğŸ‡¹", pais: "guatemala" },
  { emoji: "ğŸ‡¬ğŸ‡³", pais: "guinea" },
  { emoji: "ğŸ‡¬ğŸ‡¼", pais: "guinea-bisÃ¡u" },
  { emoji: "ğŸ‡¬ğŸ‡¶", pais: "guinea ecuatorial" },
  { emoji: "ğŸ‡¬ğŸ‡¾", pais: "guyana" },
  { emoji: "ğŸ‡­ğŸ‡¹", pais: "haitÃ­" },
  { emoji: "ğŸ‡­ğŸ‡³", pais: "honduras" },
  { emoji: "ğŸ‡­ğŸ‡º", pais: "hungrÃ­a" },
  { emoji: "ğŸ‡®ğŸ‡³", pais: "india" },
  { emoji: "ğŸ‡®ğŸ‡©", pais: "indonesia" },
  { emoji: "ğŸ‡®ğŸ‡·", pais: "irÃ¡n" },
  { emoji: "ğŸ‡®ğŸ‡¶", pais: "irak" },
  { emoji: "ğŸ‡®ğŸ‡ª", pais: "irlanda" },
  { emoji: "ğŸ‡®ğŸ‡¸", pais: "islandia" },
  { emoji: "ğŸ‡®ğŸ‡±", pais: "israel" },
  { emoji: "ğŸ‡®ğŸ‡¹", pais: "italia" },
  { emoji: "ğŸ‡¯ğŸ‡²", pais: "jamaica" },
  { emoji: "ğŸ‡¯ğŸ‡µ", pais: "japÃ³n" },
  { emoji: "ğŸ‡¯ğŸ‡´", pais: "jordania" },
  { emoji: "ğŸ‡°ğŸ‡¿", pais: "kazajistÃ¡n" },
  { emoji: "ğŸ‡°ğŸ‡ª", pais: "kenia" },
  { emoji: "ğŸ‡°ğŸ‡¬", pais: "kirguistÃ¡n" },
  { emoji: "ğŸ‡°ğŸ‡®", pais: "kiribati" },
  { emoji: "ğŸ‡°ğŸ‡¼", pais: "kuwait" },
  { emoji: "ğŸ‡±ğŸ‡¦", pais: "laos" },
  { emoji: "ğŸ‡±ğŸ‡¸", pais: "lesoto" },
  { emoji: "ğŸ‡±ğŸ‡»", pais: "letonia" },
  { emoji: "ğŸ‡±ğŸ‡§", pais: "lÃ­bano" },
  { emoji: "ğŸ‡±ğŸ‡·", pais: "liberia" },
  { emoji: "ğŸ‡±ğŸ‡¾", pais: "libia" },
  { emoji: "ğŸ‡±ğŸ‡®", pais: "liechtenstein" },
  { emoji: "ğŸ‡±ğŸ‡¹", pais: "lituania" },
  { emoji: "ğŸ‡±ğŸ‡º", pais: "luxemburgo" },
  { emoji: "ğŸ‡²ğŸ‡¬", pais: "madagascar" },
  { emoji: "ğŸ‡²ğŸ‡¾", pais: "malasia" },
  { emoji: "ğŸ‡²ğŸ‡¼", pais: "malaui" },
  { emoji: "ğŸ‡²ğŸ‡»", pais: "maldivas" },
  { emoji: "ğŸ‡²ğŸ‡±", pais: "malÃ­" },
  { emoji: "ğŸ‡²ğŸ‡¹", pais: "malta" },
  { emoji: "ğŸ‡²ğŸ‡­", pais: "islas marshall" },
  { emoji: "ğŸ‡²ğŸ‡·", pais: "mauritania" },
  { emoji: "ğŸ‡²ğŸ‡º", pais: "mauricio" },
  { emoji: "ğŸ‡²ğŸ‡½", pais: "mÃ©xico" },
  { emoji: "ğŸ‡«ğŸ‡²", pais: "micronesia" },
  { emoji: "ğŸ‡²ğŸ‡©", pais: "moldavia" },
  { emoji: "ğŸ‡²ğŸ‡¨", pais: "mÃ³naco" },
  { emoji: "ğŸ‡²ğŸ‡³", pais: "mongolia" },
  { emoji: "ğŸ‡²ğŸ‡ª", pais: "montenegro" },
  { emoji: "ğŸ‡²ğŸ‡¦", pais: "marruecos" },
  { emoji: "ğŸ‡²ğŸ‡¿", pais: "mozambique" },
  { emoji: "ğŸ‡²ğŸ‡²", pais: "myanmar" },
  { emoji: "ğŸ‡³ğŸ‡¦", pais: "namibia" },
  { emoji: "ğŸ‡³ğŸ‡·", pais: "nauru" },
  { emoji: "ğŸ‡³ğŸ‡µ", pais: "nepal" },
  { emoji: "ğŸ‡³ğŸ‡®", pais: "nicaragua" },
  { emoji: "ğŸ‡³ğŸ‡ª", pais: "nÃ­ger" },
  { emoji: "ğŸ‡³ğŸ‡¬", pais: "nigeria" },
  { emoji: "ğŸ‡³ğŸ‡´", pais: "noruega" },
  { emoji: "ğŸ‡³ğŸ‡¿", pais: "nueva zelanda" },
  { emoji: "ğŸ‡´ğŸ‡²", pais: "omÃ¡n" },
  { emoji: "ğŸ‡³ğŸ‡±", pais: "paÃ­ses bajos" },
  { emoji: "ğŸ‡µğŸ‡°", pais: "pakistÃ¡n" },
  { emoji: "ğŸ‡µğŸ‡¼", pais: "palaos" },
  { emoji: "ğŸ‡µğŸ‡¦", pais: "panamÃ¡" },
  { emoji: "ğŸ‡µğŸ‡¬", pais: "papÃºa nueva guinea" },
  { emoji: "ğŸ‡µğŸ‡¾", pais: "paraguay" },
  { emoji: "ğŸ‡µğŸ‡ª", pais: "perÃº" },
  { emoji: "ğŸ‡µğŸ‡±", pais: "polonia" },
  { emoji: "ğŸ‡µğŸ‡¹", pais: "portugal" },
  { emoji: "ğŸ‡¬ğŸ‡§", pais: "reino unido" },
  { emoji: "ğŸ‡¨ğŸ‡«", pais: "repÃºblica centroafricana" },
  { emoji: "ğŸ‡¨ğŸ‡¿", pais: "repÃºblica checa" },
  { emoji: "ğŸ‡©ğŸ‡´", pais: "repÃºblica dominicana" },
  { emoji: "ğŸ‡·ğŸ‡¼", pais: "ruanda" },
  { emoji: "ğŸ‡·ğŸ‡´", pais: "rumania" },
  { emoji: "ğŸ‡·ğŸ‡º", pais: "rusia" },
  { emoji: "ğŸ‡¼ğŸ‡¸", pais: "samoa" },
  { emoji: "ğŸ‡°ğŸ‡³", pais: "san cristÃ³bal y nieves" },
  { emoji: "ğŸ‡¸ğŸ‡²", pais: "san marino" },
  { emoji: "ğŸ‡±ğŸ‡¨", pais: "santa lucÃ­a" },
  { emoji: "ğŸ‡¸ğŸ‡¹", pais: "santo tomÃ© y prÃ­ncipe" },
  { emoji: "ğŸ‡»ğŸ‡¨", pais: "san vicente y las granadinas" },
  { emoji: "ğŸ‡¸ğŸ‡³", pais: "senegal" },
  { emoji: "ğŸ‡·ğŸ‡¸", pais: "serbia" },
  { emoji: "ğŸ‡¸ğŸ‡¨", pais: "seychelles" },
  { emoji: "ğŸ‡¸ğŸ‡±", pais: "sierra leona" },
  { emoji: "ğŸ‡¸ğŸ‡¬", pais: "singapur" },
  { emoji: "ğŸ‡¸ğŸ‡¾", pais: "siria" },
  { emoji: "ğŸ‡¸ğŸ‡´", pais: "somalia" },
  { emoji: "ğŸ‡±ğŸ‡°", pais: "sri lanka" },
  { emoji: "ğŸ‡¿ğŸ‡¦", pais: "sudÃ¡frica" },
  { emoji: "ğŸ‡¸ğŸ‡©", pais: "sudÃ¡n" },
  { emoji: "ğŸ‡¸ğŸ‡¸", pais: "sudÃ¡n del sur" },
  { emoji: "ğŸ‡¸ğŸ‡ª", pais: "suecia" },
  { emoji: "ğŸ‡¨ğŸ‡­", pais: "suiza" },
  { emoji: "ğŸ‡¸ğŸ‡·", pais: "surinam" },
  { emoji: "ğŸ‡¹ğŸ‡­", pais: "tailandia" },
  { emoji: "ğŸ‡¹ğŸ‡¼", pais: "taiwÃ¡n" },
  { emoji: "ğŸ‡¹ğŸ‡¿", pais: "tanzania" },
  { emoji: "ğŸ‡¹ğŸ‡¯", pais: "tayikistÃ¡n" },
  { emoji: "ğŸ‡¹ğŸ‡±", pais: "timor oriental" },
  { emoji: "ğŸ‡¹ğŸ‡¬", pais: "togo" },
  { emoji: "ğŸ‡¹ğŸ‡´", pais: "tonga" },
  { emoji: "ğŸ‡¹ğŸ‡¹", pais: "trinidad y tobago" },
  { emoji: "ğŸ‡¹ğŸ‡³", pais: "tÃºnez" },
  { emoji: "ğŸ‡¹ğŸ‡·", pais: "turquÃ­a" },
  { emoji: "ğŸ‡¹ğŸ‡²", pais: "turkmenistÃ¡n" },
  { emoji: "ğŸ‡¹ğŸ‡»", pais: "tuvalu" },
  { emoji: "ğŸ‡ºğŸ‡¦", pais: "ucrania" },
  { emoji: "ğŸ‡ºğŸ‡¬", pais: "uganda" },
  { emoji: "ğŸ‡ºğŸ‡¾", pais: "uruguay" },
  { emoji: "ğŸ‡ºğŸ‡¿", pais: "uzbekistÃ¡n" },
  { emoji: "ğŸ‡»ğŸ‡º", pais: "vanuatu" },
  { emoji: "ğŸ‡»ğŸ‡¦", pais: "ciudad del vaticano" },
  { emoji: "ğŸ‡»ğŸ‡ª", pais: "venezuela" },
  { emoji: "ğŸ‡»ğŸ‡³", pais: "vietnam" },
  { emoji: "ğŸ‡¾ğŸ‡ª", pais: "yemen" },
  { emoji: "ğŸ‡©ğŸ‡¯", pais: "yibuti" },
  { emoji: "ğŸ‡¿ğŸ‡²", pais: "zambia" },
  { emoji: "ğŸ‡¿ğŸ‡¼", pais: "zimbabue" },
];

let banderas = {};

plugin.run = async (m, { client, chat }) => {
  if (!chat.games) return client.sendText(m.chat, txt.disabledGames, m);
  if (banderas[m.chat]) return client.sendText(m.chat, txt.gameAlready, m);

  const bandera = banderasLista[Math.floor(Math.random() * banderasLista.length)];

  const mensajeJuego = await client.sendText(m.chat, `*[ğŸŒ] ADIVINA LA BANDERA:*\n* ${bandera.emoji}\n\n*[â—] RESPONDE A ESTE MENSAJE* con el nombre del paÃ­s.\n*[â±ï¸]* 30 segundos para responder.`, m);

  banderas[m.chat] = {
    pais: bandera.pais.toLowerCase(),
    mensajeId: mensajeJuego.key.id,
    timeout: setTimeout(() => {
      if (banderas[m.chat]) {
        client.sendText(m.chat, `*[â³] Â¡Tiempo agotado!*\n\nLa respuesta era: *${bandera.pais}*`, m);
        delete banderas[m.chat];
      }
    }, 30000), // 30 segundos
  };
};

plugin.before = async function (m, { client }) {
  if (!banderas[m.chat]) return;
  const juego = banderas[m.chat];

  if (!m.quoted || m.quoted.id !== juego.mensajeId) return;

  const respuestaUsuario = m.text.toLowerCase().trim();
  if (respuestaUsuario === juego.pais) {
    client.sendText(m.chat, txt.gameSuccess, m);
    clearTimeout(banderas[m.chat].timeout);
    delete banderas[m.chat];
  } else {
    m.react("âŒ");
  }
};

export default plugin;
